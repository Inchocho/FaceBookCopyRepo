//주석 빼고실행 DROP TABLE USER_INFO_TB;
//주석 빼고실행 DROP TABLE POST_INFO_TB;

CREATE TABLE USER_INFO_TB(
	  USER_NO 			NUMBER CONSTRAINT USER_INFO_TB_PK PRIMARY KEY NOT NULL 
	, USER_NAME 		VARCHAR2(40) NOT NULL
    , USER_NICKNAME     VARCHAR2(40) CONSTRAINT USER_INFO_TB_UK UNIQUE
	, USER_PHONE_EMAIL 	VARCHAR2(40) NOT NULL
	, USER_PASSWORD 	VARCHAR2(40) NOT NULL
	, USER_BIRTH		DATE NOT NULL
	, USER_GENDER		VARCHAR2(10) NOT NULL
	, USER_CREATEDATE	DATE NOT NULL
	, USER_MODIFYDATE	DATE NOT NULL    
);

CREATE TABLE POST_INFO_TB(
      POST_NUM  NUMBER CONSTRAINT POST_INFO_TB_PK PRIMARY KEY
	, POST_NO NUMBER CONSTRAINT POST_INFO_TB_FK REFERENCES USER_INFO_TB(USER_NO) NOT NULL
    , POST_TITLE VARCHAR2(40) NOT NULL
	, POST_CONTENT VARCHAR2(4000) NOT NULL	
    , POST_CREATEDATE DATE DEFAULT SYSDATE
    , POST_MODIFYDATE DATE DEFAULT SYSDATE
    , POST_COUNT NUMBER DEFAULT 0
);

CREATE SEQUENCE USER_INFO_USER_NO_SEQ
    INCREMENT BY 1
    START WITH 1;

CREATE SEQUENCE POST_INFO_TB_POST_NUM_SEQ
    INCREMENT BY 1
    START WITH 1;
    
    
COMMENT ON TABLE USER_INFO_TB IS '유저정보 테이블';
COMMENT ON COLUMN USER_INFO_TB.USER_NO IS '유저 번호, 기본키, USER_INFO_USER_NO_SEQ 시퀀스로 증가';
COMMENT ON COLUMN USER_INFO_TB.USER_NAME IS '유저 이름';
COMMENT ON COLUMN USER_INFO_TB.USER_NICKNAME IS '유저 별명(닉네임) 고유키';
COMMENT ON COLUMN USER_INFO_TB.USER_PHONE_EMAIL IS '유저 전화번호 OR 이메일';
COMMENT ON COLUMN USER_INFO_TB.USER_PASSWORD IS '유저 비밀번호';
COMMENT ON COLUMN USER_INFO_TB.USER_BIRTH IS '유저 생일';
COMMENT ON COLUMN USER_INFO_TB.USER_GENDER IS '유저 성별';
COMMENT ON COLUMN USER_INFO_TB.USER_CREATEDATE IS '유저 생성일';
COMMENT ON COLUMN USER_INFO_TB.USER_MODIFYDATE IS '유저 정보 수정일';    

COMMENT ON TABLE POST_INFO_TB IS '게시글 상세 정보 테이블';
COMMENT ON COLUMN POST_INFO_TB.POST_NUM IS '게시글 번호, 기본키, POST_INFO_TB_POST_NUM 시퀀스로 증가';
COMMENT ON COLUMN POST_INFO_TB.POST_NO IS '외래키 참조 USER_INFO_TB(USER_NO)';
COMMENT ON COLUMN POST_INFO_TB.POST_TITLE IS '게시글 제목';
COMMENT ON COLUMN POST_INFO_TB.POST_CONTENT IS '게시글 내용';
COMMENT ON COLUMN POST_INFO_TB.POST_CREATEDATE IS '게시글 생성일';
COMMENT ON COLUMN POST_INFO_TB.POST_MODIFYDATE IS '게시글 수정일';


INSERT INTO USER_INFO_TB
VALUES(USER_INFO_USER_NO_SEQ.NEXTVAL, 
'조윤성', '조로', '0100100010', 
1234, '19970419', 'M', SYSDATE, SYSDATE); 

INSERT INTO USER_INFO_TB
VALUES(USER_INFO_USER_NO_SEQ.NEXTVAL, 
'조현석', '조로리', '0104104104', 
1234, '19921212', 'M', SYSDATE, SYSDATE); 

INSERT INTO USER_INFO_TB
VALUES(USER_INFO_USER_NO_SEQ.NEXTVAL, 
'오건황', '오로성', '0100100010', 
1234, '19930509', 'M', SYSDATE, SYSDATE); 

INSERT INTO  POST_INFO_TB
VALUES(POST_INFO_TB_POST_NUM_SEQ.NEXTVAL,
(SELECT USER_NO FROM USER_INFO_TB
WHERE USER_NAME = '조윤성'), '제목입니다', '조윤성 내용입니다', SYSDATE,
SYSDATE, 0);

INSERT INTO  POST_INFO_TB
VALUES(POST_INFO_TB_POST_NUM_SEQ.NEXTVAL,
(SELECT USER_NO FROM USER_INFO_TB
WHERE USER_NAME = '조현석'), '제목입니다', '쾌걸 조로리 내용입니다', SYSDATE,
SYSDATE, 0);

INSERT INTO  POST_INFO_TB
VALUES(POST_INFO_TB_POST_NUM_SEQ.NEXTVAL,
(SELECT USER_NO FROM USER_INFO_TB
WHERE USER_NAME = '오건황') , '제목입니다', '오건황 내용입니다', SYSDATE,
SYSDATE, 0);

INSERT INTO  POST_INFO_TB
VALUES(POST_INFO_TB_POST_NUM_SEQ.NEXTVAL,
(SELECT USER_NO FROM USER_INFO_TB
WHERE USER_NAME = '오건황') , '제목입니다', '오건황 내용입니다', SYSDATE,
SYSDATE, 0);



// 조회
SELECT * FROM USER_INFO_TB;
SELECT * FROM POST_INFO_TB;

SELECT A.*, B.* 
FROM USER_INFO_TB A, POST_INFO_TB B
WHERE A.USER_NO = B.POST_NO
AND A.USER_NAME = '오건황';